{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "b1193ecb",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns                 #importing the necessary python modules"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "9ab7dfb7",
   "metadata": {},
   "outputs": [],
   "source": [
    "data_folder = r'C:\\Users\\tejas\\OneDrive\\Documents\\Capstone_project_606\\Dataset\\Customer Churn Prediction Dataset\\telecom_customer_churn.csv'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "c6dfad86",
   "metadata": {},
   "outputs": [],
   "source": [
    "telecom_data = pd.read_csv(data_folder) #reading the csv file "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "b6b80d40",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Customer ID</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Married</th>\n",
       "      <th>Number of Dependents</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Number of Referrals</th>\n",
       "      <th>...</th>\n",
       "      <th>Payment Method</th>\n",
       "      <th>Monthly Charge</th>\n",
       "      <th>Total Charges</th>\n",
       "      <th>Total Refunds</th>\n",
       "      <th>Total Extra Data Charges</th>\n",
       "      <th>Total Long Distance Charges</th>\n",
       "      <th>Total Revenue</th>\n",
       "      <th>Customer Status</th>\n",
       "      <th>Churn Category</th>\n",
       "      <th>Churn Reason</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0002-ORFBO</td>\n",
       "      <td>Female</td>\n",
       "      <td>37</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Frazier Park</td>\n",
       "      <td>93225</td>\n",
       "      <td>34.827662</td>\n",
       "      <td>-118.999073</td>\n",
       "      <td>2</td>\n",
       "      <td>...</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>65.60</td>\n",
       "      <td>593.30</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>381.51</td>\n",
       "      <td>974.81</td>\n",
       "      <td>Stayed</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0003-MKNFE</td>\n",
       "      <td>Male</td>\n",
       "      <td>46</td>\n",
       "      <td>No</td>\n",
       "      <td>0</td>\n",
       "      <td>Glendale</td>\n",
       "      <td>91206</td>\n",
       "      <td>34.162515</td>\n",
       "      <td>-118.203869</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>-4.00</td>\n",
       "      <td>542.40</td>\n",
       "      <td>38.33</td>\n",
       "      <td>10</td>\n",
       "      <td>96.21</td>\n",
       "      <td>610.28</td>\n",
       "      <td>Stayed</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0004-TLHLJ</td>\n",
       "      <td>Male</td>\n",
       "      <td>50</td>\n",
       "      <td>No</td>\n",
       "      <td>0</td>\n",
       "      <td>Costa Mesa</td>\n",
       "      <td>92627</td>\n",
       "      <td>33.645672</td>\n",
       "      <td>-117.922613</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>73.90</td>\n",
       "      <td>280.85</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>134.60</td>\n",
       "      <td>415.45</td>\n",
       "      <td>Churned</td>\n",
       "      <td>Competitor</td>\n",
       "      <td>Competitor had better devices</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>0011-IGKFF</td>\n",
       "      <td>Male</td>\n",
       "      <td>78</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Martinez</td>\n",
       "      <td>94553</td>\n",
       "      <td>38.014457</td>\n",
       "      <td>-122.115432</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>98.00</td>\n",
       "      <td>1237.85</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>361.66</td>\n",
       "      <td>1599.51</td>\n",
       "      <td>Churned</td>\n",
       "      <td>Dissatisfaction</td>\n",
       "      <td>Product dissatisfaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0013-EXCHZ</td>\n",
       "      <td>Female</td>\n",
       "      <td>75</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Camarillo</td>\n",
       "      <td>93010</td>\n",
       "      <td>34.227846</td>\n",
       "      <td>-119.079903</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>83.90</td>\n",
       "      <td>267.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>22.14</td>\n",
       "      <td>289.54</td>\n",
       "      <td>Churned</td>\n",
       "      <td>Dissatisfaction</td>\n",
       "      <td>Network reliability</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7038</th>\n",
       "      <td>9987-LUTYD</td>\n",
       "      <td>Female</td>\n",
       "      <td>20</td>\n",
       "      <td>No</td>\n",
       "      <td>0</td>\n",
       "      <td>La Mesa</td>\n",
       "      <td>91941</td>\n",
       "      <td>32.759327</td>\n",
       "      <td>-116.997260</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>55.15</td>\n",
       "      <td>742.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>606.84</td>\n",
       "      <td>1349.74</td>\n",
       "      <td>Stayed</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7039</th>\n",
       "      <td>9992-RRAMN</td>\n",
       "      <td>Male</td>\n",
       "      <td>40</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Riverbank</td>\n",
       "      <td>95367</td>\n",
       "      <td>37.734971</td>\n",
       "      <td>-120.954271</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>85.10</td>\n",
       "      <td>1873.70</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>356.40</td>\n",
       "      <td>2230.10</td>\n",
       "      <td>Churned</td>\n",
       "      <td>Dissatisfaction</td>\n",
       "      <td>Product dissatisfaction</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7040</th>\n",
       "      <td>9992-UJOEL</td>\n",
       "      <td>Male</td>\n",
       "      <td>22</td>\n",
       "      <td>No</td>\n",
       "      <td>0</td>\n",
       "      <td>Elk</td>\n",
       "      <td>95432</td>\n",
       "      <td>39.108252</td>\n",
       "      <td>-123.645121</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>50.30</td>\n",
       "      <td>92.75</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>37.24</td>\n",
       "      <td>129.99</td>\n",
       "      <td>Joined</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7041</th>\n",
       "      <td>9993-LHIEB</td>\n",
       "      <td>Male</td>\n",
       "      <td>21</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Solana Beach</td>\n",
       "      <td>92075</td>\n",
       "      <td>33.001813</td>\n",
       "      <td>-117.263628</td>\n",
       "      <td>5</td>\n",
       "      <td>...</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>67.85</td>\n",
       "      <td>4627.65</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>142.04</td>\n",
       "      <td>4769.69</td>\n",
       "      <td>Stayed</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7042</th>\n",
       "      <td>9995-HOTOH</td>\n",
       "      <td>Male</td>\n",
       "      <td>36</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Sierra City</td>\n",
       "      <td>96125</td>\n",
       "      <td>39.600599</td>\n",
       "      <td>-120.636358</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>59.00</td>\n",
       "      <td>3707.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3707.60</td>\n",
       "      <td>Stayed</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>7043 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Customer ID  Gender  Age Married  Number of Dependents          City  \\\n",
       "0     0002-ORFBO  Female   37     Yes                     0  Frazier Park   \n",
       "1     0003-MKNFE    Male   46      No                     0      Glendale   \n",
       "2     0004-TLHLJ    Male   50      No                     0    Costa Mesa   \n",
       "3     0011-IGKFF    Male   78     Yes                     0      Martinez   \n",
       "4     0013-EXCHZ  Female   75     Yes                     0     Camarillo   \n",
       "...          ...     ...  ...     ...                   ...           ...   \n",
       "7038  9987-LUTYD  Female   20      No                     0       La Mesa   \n",
       "7039  9992-RRAMN    Male   40     Yes                     0     Riverbank   \n",
       "7040  9992-UJOEL    Male   22      No                     0           Elk   \n",
       "7041  9993-LHIEB    Male   21     Yes                     0  Solana Beach   \n",
       "7042  9995-HOTOH    Male   36     Yes                     0   Sierra City   \n",
       "\n",
       "      Zip Code   Latitude   Longitude  Number of Referrals  ...  \\\n",
       "0        93225  34.827662 -118.999073                    2  ...   \n",
       "1        91206  34.162515 -118.203869                    0  ...   \n",
       "2        92627  33.645672 -117.922613                    0  ...   \n",
       "3        94553  38.014457 -122.115432                    1  ...   \n",
       "4        93010  34.227846 -119.079903                    3  ...   \n",
       "...        ...        ...         ...                  ...  ...   \n",
       "7038     91941  32.759327 -116.997260                    0  ...   \n",
       "7039     95367  37.734971 -120.954271                    1  ...   \n",
       "7040     95432  39.108252 -123.645121                    0  ...   \n",
       "7041     92075  33.001813 -117.263628                    5  ...   \n",
       "7042     96125  39.600599 -120.636358                    1  ...   \n",
       "\n",
       "       Payment Method Monthly Charge Total Charges  Total Refunds  \\\n",
       "0         Credit Card          65.60        593.30           0.00   \n",
       "1         Credit Card          -4.00        542.40          38.33   \n",
       "2     Bank Withdrawal          73.90        280.85           0.00   \n",
       "3     Bank Withdrawal          98.00       1237.85           0.00   \n",
       "4         Credit Card          83.90        267.40           0.00   \n",
       "...               ...            ...           ...            ...   \n",
       "7038      Credit Card          55.15        742.90           0.00   \n",
       "7039  Bank Withdrawal          85.10       1873.70           0.00   \n",
       "7040      Credit Card          50.30         92.75           0.00   \n",
       "7041      Credit Card          67.85       4627.65           0.00   \n",
       "7042  Bank Withdrawal          59.00       3707.60           0.00   \n",
       "\n",
       "     Total Extra Data Charges Total Long Distance Charges Total Revenue  \\\n",
       "0                           0                      381.51        974.81   \n",
       "1                          10                       96.21        610.28   \n",
       "2                           0                      134.60        415.45   \n",
       "3                           0                      361.66       1599.51   \n",
       "4                           0                       22.14        289.54   \n",
       "...                       ...                         ...           ...   \n",
       "7038                        0                      606.84       1349.74   \n",
       "7039                        0                      356.40       2230.10   \n",
       "7040                        0                       37.24        129.99   \n",
       "7041                        0                      142.04       4769.69   \n",
       "7042                        0                        0.00       3707.60   \n",
       "\n",
       "      Customer Status   Churn Category                   Churn Reason  \n",
       "0              Stayed              NaN                            NaN  \n",
       "1              Stayed              NaN                            NaN  \n",
       "2             Churned       Competitor  Competitor had better devices  \n",
       "3             Churned  Dissatisfaction        Product dissatisfaction  \n",
       "4             Churned  Dissatisfaction            Network reliability  \n",
       "...               ...              ...                            ...  \n",
       "7038           Stayed              NaN                            NaN  \n",
       "7039          Churned  Dissatisfaction        Product dissatisfaction  \n",
       "7040           Joined              NaN                            NaN  \n",
       "7041           Stayed              NaN                            NaN  \n",
       "7042           Stayed              NaN                            NaN  \n",
       "\n",
       "[7043 rows x 38 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "telecom_data #printing the data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "d62d8c2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#Dropping the Customer ID, Churn Category and Churn reason columns\n",
    "telecom_data = telecom_data.drop('Churn Category',axis=1)\n",
    "telecom_data = telecom_data.drop('Churn Reason',axis=1)\n",
    "telecom_data = telecom_data.drop('Customer ID',axis=1)\n",
    "\n",
    "#Dropping the data values of \"Joined\" category in the customer status\n",
    "telecom_data = telecom_data.loc[telecom_data['Customer Status'] != 'Joined']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "1b5ed7df",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Converting the variables as Categorical for the model prediction for the machine learning model.\n",
    "\n",
    "telecom_data['Gender'] = pd.Categorical(telecom_data.Gender)\n",
    "telecom_data['City'] = pd.Categorical(telecom_data.City)\n",
    "telecom_data['Zip Code'] = pd.Categorical(telecom_data['Zip Code'])\n",
    "telecom_data['Married'] = pd.Categorical(telecom_data.Married)\n",
    "telecom_data['Phone Service'] = pd.Categorical(telecom_data['Phone Service'])\n",
    "telecom_data['Multiple Lines'] = pd.Categorical(telecom_data['Multiple Lines'])\n",
    "telecom_data['Internet Service'] = pd.Categorical(telecom_data['Internet Service'])\n",
    "telecom_data['Internet Type'] = pd.Categorical(telecom_data['Internet Type'])\n",
    "telecom_data['Online Security'] = pd.Categorical(telecom_data['Online Security'])\n",
    "telecom_data['Online Backup'] = pd.Categorical(telecom_data['Online Backup'])\n",
    "telecom_data['Device Protection Plan'] = pd.Categorical(telecom_data['Device Protection Plan'])\n",
    "telecom_data['Premium Tech Support'] = pd.Categorical(telecom_data['Premium Tech Support'])\n",
    "telecom_data['Streaming TV'] = pd.Categorical(telecom_data['Streaming TV'])\n",
    "telecom_data['Streaming Movies'] = pd.Categorical(telecom_data['Streaming Movies'])\n",
    "telecom_data['Streaming Music'] = pd.Categorical(telecom_data['Streaming Music'])\n",
    "telecom_data['Unlimited Data'] = pd.Categorical(telecom_data['Unlimited Data'])\n",
    "telecom_data['Contract'] = pd.Categorical(telecom_data['Contract'])\n",
    "telecom_data['Paperless Billing'] = pd.Categorical(telecom_data['Paperless Billing'])\n",
    "telecom_data['Payment Method'] = pd.Categorical(telecom_data['Payment Method'])\n",
    "telecom_data['Payment Method'] = pd.Categorical(telecom_data['Payment Method'])\n",
    "telecom_data['Customer Status'] = pd.Categorical(telecom_data['Customer Status'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "3750f467",
   "metadata": {},
   "outputs": [],
   "source": [
    "#creating the copy of the \"telecom_data\" dataframe and assigning it to \"data_frame\"\n",
    "data_frame = telecom_data.copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "2e905ee5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Married</th>\n",
       "      <th>Number of Dependents</th>\n",
       "      <th>City</th>\n",
       "      <th>Zip Code</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Number of Referrals</th>\n",
       "      <th>Tenure in Months</th>\n",
       "      <th>...</th>\n",
       "      <th>Contract</th>\n",
       "      <th>Paperless Billing</th>\n",
       "      <th>Payment Method</th>\n",
       "      <th>Monthly Charge</th>\n",
       "      <th>Total Charges</th>\n",
       "      <th>Total Refunds</th>\n",
       "      <th>Total Extra Data Charges</th>\n",
       "      <th>Total Long Distance Charges</th>\n",
       "      <th>Total Revenue</th>\n",
       "      <th>Customer Status</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Female</td>\n",
       "      <td>37</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Frazier Park</td>\n",
       "      <td>93225</td>\n",
       "      <td>34.827662</td>\n",
       "      <td>-118.999073</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>One Year</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>65.60</td>\n",
       "      <td>593.30</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>381.51</td>\n",
       "      <td>974.81</td>\n",
       "      <td>Stayed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Male</td>\n",
       "      <td>46</td>\n",
       "      <td>No</td>\n",
       "      <td>0</td>\n",
       "      <td>Glendale</td>\n",
       "      <td>91206</td>\n",
       "      <td>34.162515</td>\n",
       "      <td>-118.203869</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>...</td>\n",
       "      <td>Month-to-Month</td>\n",
       "      <td>No</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>-4.00</td>\n",
       "      <td>542.40</td>\n",
       "      <td>38.33</td>\n",
       "      <td>10</td>\n",
       "      <td>96.21</td>\n",
       "      <td>610.28</td>\n",
       "      <td>Stayed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Male</td>\n",
       "      <td>50</td>\n",
       "      <td>No</td>\n",
       "      <td>0</td>\n",
       "      <td>Costa Mesa</td>\n",
       "      <td>92627</td>\n",
       "      <td>33.645672</td>\n",
       "      <td>-117.922613</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>Month-to-Month</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>73.90</td>\n",
       "      <td>280.85</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>134.60</td>\n",
       "      <td>415.45</td>\n",
       "      <td>Churned</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Male</td>\n",
       "      <td>78</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Martinez</td>\n",
       "      <td>94553</td>\n",
       "      <td>38.014457</td>\n",
       "      <td>-122.115432</td>\n",
       "      <td>1</td>\n",
       "      <td>13</td>\n",
       "      <td>...</td>\n",
       "      <td>Month-to-Month</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>98.00</td>\n",
       "      <td>1237.85</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>361.66</td>\n",
       "      <td>1599.51</td>\n",
       "      <td>Churned</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Female</td>\n",
       "      <td>75</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Camarillo</td>\n",
       "      <td>93010</td>\n",
       "      <td>34.227846</td>\n",
       "      <td>-119.079903</td>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>...</td>\n",
       "      <td>Month-to-Month</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>83.90</td>\n",
       "      <td>267.40</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>22.14</td>\n",
       "      <td>289.54</td>\n",
       "      <td>Churned</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7037</th>\n",
       "      <td>Female</td>\n",
       "      <td>36</td>\n",
       "      <td>No</td>\n",
       "      <td>0</td>\n",
       "      <td>Fallbrook</td>\n",
       "      <td>92028</td>\n",
       "      <td>33.362575</td>\n",
       "      <td>-117.299644</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>...</td>\n",
       "      <td>Month-to-Month</td>\n",
       "      <td>No</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>20.95</td>\n",
       "      <td>85.50</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>8.04</td>\n",
       "      <td>93.54</td>\n",
       "      <td>Churned</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7038</th>\n",
       "      <td>Female</td>\n",
       "      <td>20</td>\n",
       "      <td>No</td>\n",
       "      <td>0</td>\n",
       "      <td>La Mesa</td>\n",
       "      <td>91941</td>\n",
       "      <td>32.759327</td>\n",
       "      <td>-116.997260</td>\n",
       "      <td>0</td>\n",
       "      <td>13</td>\n",
       "      <td>...</td>\n",
       "      <td>One Year</td>\n",
       "      <td>No</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>55.15</td>\n",
       "      <td>742.90</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>606.84</td>\n",
       "      <td>1349.74</td>\n",
       "      <td>Stayed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7039</th>\n",
       "      <td>Male</td>\n",
       "      <td>40</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Riverbank</td>\n",
       "      <td>95367</td>\n",
       "      <td>37.734971</td>\n",
       "      <td>-120.954271</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>...</td>\n",
       "      <td>Month-to-Month</td>\n",
       "      <td>Yes</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>85.10</td>\n",
       "      <td>1873.70</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>356.40</td>\n",
       "      <td>2230.10</td>\n",
       "      <td>Churned</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7041</th>\n",
       "      <td>Male</td>\n",
       "      <td>21</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Solana Beach</td>\n",
       "      <td>92075</td>\n",
       "      <td>33.001813</td>\n",
       "      <td>-117.263628</td>\n",
       "      <td>5</td>\n",
       "      <td>67</td>\n",
       "      <td>...</td>\n",
       "      <td>Two Year</td>\n",
       "      <td>No</td>\n",
       "      <td>Credit Card</td>\n",
       "      <td>67.85</td>\n",
       "      <td>4627.65</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>142.04</td>\n",
       "      <td>4769.69</td>\n",
       "      <td>Stayed</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7042</th>\n",
       "      <td>Male</td>\n",
       "      <td>36</td>\n",
       "      <td>Yes</td>\n",
       "      <td>0</td>\n",
       "      <td>Sierra City</td>\n",
       "      <td>96125</td>\n",
       "      <td>39.600599</td>\n",
       "      <td>-120.636358</td>\n",
       "      <td>1</td>\n",
       "      <td>63</td>\n",
       "      <td>...</td>\n",
       "      <td>Two Year</td>\n",
       "      <td>No</td>\n",
       "      <td>Bank Withdrawal</td>\n",
       "      <td>59.00</td>\n",
       "      <td>3707.60</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0</td>\n",
       "      <td>0.00</td>\n",
       "      <td>3707.60</td>\n",
       "      <td>Stayed</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>6589 rows × 35 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      Gender  Age Married  Number of Dependents          City Zip Code  \\\n",
       "0     Female   37     Yes                     0  Frazier Park    93225   \n",
       "1       Male   46      No                     0      Glendale    91206   \n",
       "2       Male   50      No                     0    Costa Mesa    92627   \n",
       "3       Male   78     Yes                     0      Martinez    94553   \n",
       "4     Female   75     Yes                     0     Camarillo    93010   \n",
       "...      ...  ...     ...                   ...           ...      ...   \n",
       "7037  Female   36      No                     0     Fallbrook    92028   \n",
       "7038  Female   20      No                     0       La Mesa    91941   \n",
       "7039    Male   40     Yes                     0     Riverbank    95367   \n",
       "7041    Male   21     Yes                     0  Solana Beach    92075   \n",
       "7042    Male   36     Yes                     0   Sierra City    96125   \n",
       "\n",
       "       Latitude   Longitude  Number of Referrals  Tenure in Months  ...  \\\n",
       "0     34.827662 -118.999073                    2                 9  ...   \n",
       "1     34.162515 -118.203869                    0                 9  ...   \n",
       "2     33.645672 -117.922613                    0                 4  ...   \n",
       "3     38.014457 -122.115432                    1                13  ...   \n",
       "4     34.227846 -119.079903                    3                 3  ...   \n",
       "...         ...         ...                  ...               ...  ...   \n",
       "7037  33.362575 -117.299644                    0                 4  ...   \n",
       "7038  32.759327 -116.997260                    0                13  ...   \n",
       "7039  37.734971 -120.954271                    1                22  ...   \n",
       "7041  33.001813 -117.263628                    5                67  ...   \n",
       "7042  39.600599 -120.636358                    1                63  ...   \n",
       "\n",
       "            Contract Paperless Billing   Payment Method Monthly Charge  \\\n",
       "0           One Year               Yes      Credit Card          65.60   \n",
       "1     Month-to-Month                No      Credit Card          -4.00   \n",
       "2     Month-to-Month               Yes  Bank Withdrawal          73.90   \n",
       "3     Month-to-Month               Yes  Bank Withdrawal          98.00   \n",
       "4     Month-to-Month               Yes      Credit Card          83.90   \n",
       "...              ...               ...              ...            ...   \n",
       "7037  Month-to-Month                No  Bank Withdrawal          20.95   \n",
       "7038        One Year                No      Credit Card          55.15   \n",
       "7039  Month-to-Month               Yes  Bank Withdrawal          85.10   \n",
       "7041        Two Year                No      Credit Card          67.85   \n",
       "7042        Two Year                No  Bank Withdrawal          59.00   \n",
       "\n",
       "     Total Charges Total Refunds  Total Extra Data Charges  \\\n",
       "0           593.30          0.00                         0   \n",
       "1           542.40         38.33                        10   \n",
       "2           280.85          0.00                         0   \n",
       "3          1237.85          0.00                         0   \n",
       "4           267.40          0.00                         0   \n",
       "...            ...           ...                       ...   \n",
       "7037         85.50          0.00                         0   \n",
       "7038        742.90          0.00                         0   \n",
       "7039       1873.70          0.00                         0   \n",
       "7041       4627.65          0.00                         0   \n",
       "7042       3707.60          0.00                         0   \n",
       "\n",
       "     Total Long Distance Charges Total Revenue Customer Status  \n",
       "0                         381.51        974.81          Stayed  \n",
       "1                          96.21        610.28          Stayed  \n",
       "2                         134.60        415.45         Churned  \n",
       "3                         361.66       1599.51         Churned  \n",
       "4                          22.14        289.54         Churned  \n",
       "...                          ...           ...             ...  \n",
       "7037                        8.04         93.54         Churned  \n",
       "7038                      606.84       1349.74          Stayed  \n",
       "7039                      356.40       2230.10         Churned  \n",
       "7041                      142.04       4769.69          Stayed  \n",
       "7042                        0.00       3707.60          Stayed  \n",
       "\n",
       "[6589 rows x 35 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data_frame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "4d5bac86",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_X = telecom_data.drop('Customer Status', axis=1) #dropping the 'Customer Status' column\n",
    "df_y = telecom_data['Customer Status'] #creating the new dataframe with selecting the 'Customer Status' column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "319eddba",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<style>#sk-container-id-1 {color: black;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;imputer&#x27;,\n",
       "                                                  SimpleImputer(strategy=&#x27;median&#x27;)),\n",
       "                                                 (&#x27;scaler&#x27;, StandardScaler())]),\n",
       "                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x000002155A213C90&gt;),\n",
       "                                (&#x27;cat&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;imputer&#x27;,\n",
       "                                                  SimpleImputer(strategy=&#x27;most_frequent&#x27;)),\n",
       "                                                 (&#x27;cat_encoder&#x27;,\n",
       "                                                  OneHotEncoder(sparse=False))]),\n",
       "                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x00000215593CAE10&gt;)])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">ColumnTransformer</label><div class=\"sk-toggleable__content\"><pre>ColumnTransformer(transformers=[(&#x27;num&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;imputer&#x27;,\n",
       "                                                  SimpleImputer(strategy=&#x27;median&#x27;)),\n",
       "                                                 (&#x27;scaler&#x27;, StandardScaler())]),\n",
       "                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x000002155A213C90&gt;),\n",
       "                                (&#x27;cat&#x27;,\n",
       "                                 Pipeline(steps=[(&#x27;imputer&#x27;,\n",
       "                                                  SimpleImputer(strategy=&#x27;most_frequent&#x27;)),\n",
       "                                                 (&#x27;cat_encoder&#x27;,\n",
       "                                                  OneHotEncoder(sparse=False))]),\n",
       "                                 &lt;sklearn.compose._column_transformer.make_column_selector object at 0x00000215593CAE10&gt;)])</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">num</label><div class=\"sk-toggleable__content\"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x000002155A213C90&gt;</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SimpleImputer</label><div class=\"sk-toggleable__content\"><pre>SimpleImputer(strategy=&#x27;median&#x27;)</pre></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">StandardScaler</label><div class=\"sk-toggleable__content\"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" ><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">cat</label><div class=\"sk-toggleable__content\"><pre>&lt;sklearn.compose._column_transformer.make_column_selector object at 0x00000215593CAE10&gt;</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-6\" type=\"checkbox\" ><label for=\"sk-estimator-id-6\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SimpleImputer</label><div class=\"sk-toggleable__content\"><pre>SimpleImputer(strategy=&#x27;most_frequent&#x27;)</pre></div></div></div><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-7\" type=\"checkbox\" ><label for=\"sk-estimator-id-7\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">OneHotEncoder</label><div class=\"sk-toggleable__content\"><pre>OneHotEncoder(sparse=False)</pre></div></div></div></div></div></div></div></div></div></div></div></div>"
      ],
      "text/plain": [
       "ColumnTransformer(transformers=[('num',\n",
       "                                 Pipeline(steps=[('imputer',\n",
       "                                                  SimpleImputer(strategy='median')),\n",
       "                                                 ('scaler', StandardScaler())]),\n",
       "                                 <sklearn.compose._column_transformer.make_column_selector object at 0x000002155A213C90>),\n",
       "                                ('cat',\n",
       "                                 Pipeline(steps=[('imputer',\n",
       "                                                  SimpleImputer(strategy='most_frequent')),\n",
       "                                                 ('cat_encoder',\n",
       "                                                  OneHotEncoder(sparse=False))]),\n",
       "                                 <sklearn.compose._column_transformer.make_column_selector object at 0x00000215593CAE10>)])"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.pipeline import Pipeline\n",
    "from sklearn.impute import SimpleImputer\n",
    "from sklearn.preprocessing import StandardScaler, OneHotEncoder\n",
    "from sklearn.feature_selection import SequentialFeatureSelector\n",
    "from sklearn.compose import ColumnTransformer, make_column_selector\n",
    "from sklearn.pipeline import make_pipeline\n",
    "\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.neighbors import KNeighborsClassifier\n",
    "from sklearn.model_selection import GridSearchCV\n",
    "\n",
    "from sklearn import set_config\n",
    "set_config(display='diagram') # shows the pipeline graphically when printed\n",
    "\n",
    "numerical_pipeline = Pipeline([\n",
    "        ('imputer', SimpleImputer(strategy='median')),\n",
    "        ('scaler', StandardScaler())\n",
    "    ])\n",
    "categorial_pipeline = Pipeline([\n",
    "        ('imputer', SimpleImputer(strategy='most_frequent')),\n",
    "        ('cat_encoder', OneHotEncoder(sparse=False)) \n",
    "    # returns a regular matrix that can be combined easily with the data we get fromthe numeric pipeline\n",
    "    ])\n",
    "\n",
    "SimpleImputer.get_feature_names_out = StandardScaler.get_feature_names_out  #\n",
    "\n",
    "prep_pipeline = ColumnTransformer([\n",
    "    ('num', numerical_pipeline, make_column_selector(dtype_include=np.number)),\n",
    "    ('cat', categorial_pipeline, make_column_selector(dtype_include='category'))\n",
    "])\n",
    "\n",
    "prep_pipeline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "edaca85b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(6589, 2783)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\tejas\\anaconda3\\Lib\\site-packages\\sklearn\\preprocessing\\_encoders.py:972: FutureWarning: `sparse` was renamed to `sparse_output` in version 1.2 and will be removed in 1.4. `sparse_output` is ignored unless you leave `sparse` to its default value.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>num__Age</th>\n",
       "      <th>num__Number of Dependents</th>\n",
       "      <th>num__Latitude</th>\n",
       "      <th>num__Longitude</th>\n",
       "      <th>num__Number of Referrals</th>\n",
       "      <th>num__Tenure in Months</th>\n",
       "      <th>num__Avg Monthly Long Distance Charges</th>\n",
       "      <th>num__Avg Monthly GB Download</th>\n",
       "      <th>num__Monthly Charge</th>\n",
       "      <th>num__Total Charges</th>\n",
       "      <th>...</th>\n",
       "      <th>cat__Unlimited Data_No</th>\n",
       "      <th>cat__Unlimited Data_Yes</th>\n",
       "      <th>cat__Contract_Month-to-Month</th>\n",
       "      <th>cat__Contract_One Year</th>\n",
       "      <th>cat__Contract_Two Year</th>\n",
       "      <th>cat__Paperless Billing_No</th>\n",
       "      <th>cat__Paperless Billing_Yes</th>\n",
       "      <th>cat__Payment Method_Bank Withdrawal</th>\n",
       "      <th>cat__Payment Method_Credit Card</th>\n",
       "      <th>cat__Payment Method_Mailed Check</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-0.579600</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.554996</td>\n",
       "      <td>0.351930</td>\n",
       "      <td>-0.006926</td>\n",
       "      <td>-1.063957</td>\n",
       "      <td>1.251090</td>\n",
       "      <td>-0.521001</td>\n",
       "      <td>0.018307</td>\n",
       "      <td>-0.811689</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>-0.045161</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.824038</td>\n",
       "      <td>0.720843</td>\n",
       "      <td>-0.668349</td>\n",
       "      <td>-1.063957</td>\n",
       "      <td>-1.099540</td>\n",
       "      <td>-0.862269</td>\n",
       "      <td>-2.219753</td>\n",
       "      <td>-0.834158</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.192368</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-1.033094</td>\n",
       "      <td>0.851324</td>\n",
       "      <td>-0.668349</td>\n",
       "      <td>-1.272578</td>\n",
       "      <td>0.602998</td>\n",
       "      <td>0.275292</td>\n",
       "      <td>0.285202</td>\n",
       "      <td>-0.949616</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.855067</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>0.734020</td>\n",
       "      <td>-1.093819</td>\n",
       "      <td>-0.337638</td>\n",
       "      <td>-0.897060</td>\n",
       "      <td>0.170690</td>\n",
       "      <td>-1.203538</td>\n",
       "      <td>1.060162</td>\n",
       "      <td>-0.527161</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.676921</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.797613</td>\n",
       "      <td>0.314431</td>\n",
       "      <td>0.323785</td>\n",
       "      <td>-1.314302</td>\n",
       "      <td>-1.344984</td>\n",
       "      <td>-0.805391</td>\n",
       "      <td>0.606762</td>\n",
       "      <td>-0.955553</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 2783 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   num__Age  num__Number of Dependents  num__Latitude  num__Longitude  \\\n",
       "0 -0.579600                  -0.491619      -0.554996        0.351930   \n",
       "1 -0.045161                  -0.491619      -0.824038        0.720843   \n",
       "2  0.192368                  -0.491619      -1.033094        0.851324   \n",
       "3  1.855067                  -0.491619       0.734020       -1.093819   \n",
       "4  1.676921                  -0.491619      -0.797613        0.314431   \n",
       "\n",
       "   num__Number of Referrals  num__Tenure in Months  \\\n",
       "0                 -0.006926              -1.063957   \n",
       "1                 -0.668349              -1.063957   \n",
       "2                 -0.668349              -1.272578   \n",
       "3                 -0.337638              -0.897060   \n",
       "4                  0.323785              -1.314302   \n",
       "\n",
       "   num__Avg Monthly Long Distance Charges  num__Avg Monthly GB Download  \\\n",
       "0                                1.251090                     -0.521001   \n",
       "1                               -1.099540                     -0.862269   \n",
       "2                                0.602998                      0.275292   \n",
       "3                                0.170690                     -1.203538   \n",
       "4                               -1.344984                     -0.805391   \n",
       "\n",
       "   num__Monthly Charge  num__Total Charges  ...  cat__Unlimited Data_No  \\\n",
       "0             0.018307           -0.811689  ...                     0.0   \n",
       "1            -2.219753           -0.834158  ...                     1.0   \n",
       "2             0.285202           -0.949616  ...                     0.0   \n",
       "3             1.060162           -0.527161  ...                     0.0   \n",
       "4             0.606762           -0.955553  ...                     0.0   \n",
       "\n",
       "   cat__Unlimited Data_Yes  cat__Contract_Month-to-Month  \\\n",
       "0                      1.0                           0.0   \n",
       "1                      0.0                           1.0   \n",
       "2                      1.0                           1.0   \n",
       "3                      1.0                           1.0   \n",
       "4                      1.0                           1.0   \n",
       "\n",
       "   cat__Contract_One Year  cat__Contract_Two Year  cat__Paperless Billing_No  \\\n",
       "0                     1.0                     0.0                        0.0   \n",
       "1                     0.0                     0.0                        1.0   \n",
       "2                     0.0                     0.0                        0.0   \n",
       "3                     0.0                     0.0                        0.0   \n",
       "4                     0.0                     0.0                        0.0   \n",
       "\n",
       "   cat__Paperless Billing_Yes  cat__Payment Method_Bank Withdrawal  \\\n",
       "0                         1.0                                  0.0   \n",
       "1                         0.0                                  0.0   \n",
       "2                         1.0                                  1.0   \n",
       "3                         1.0                                  1.0   \n",
       "4                         1.0                                  0.0   \n",
       "\n",
       "   cat__Payment Method_Credit Card  cat__Payment Method_Mailed Check  \n",
       "0                              1.0                               0.0  \n",
       "1                              1.0                               0.0  \n",
       "2                              0.0                               0.0  \n",
       "3                              0.0                               0.0  \n",
       "4                              1.0                               0.0  \n",
       "\n",
       "[5 rows x 2783 columns]"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "processed_X = prep_pipeline.fit_transform(df_X, df_y)\n",
    "df_processed_X = pd.DataFrame(processed_X,\n",
    "                              columns = prep_pipeline.get_feature_names_out(),\n",
    "                              index = df_X.index)\n",
    "print(df_processed_X.shape)\n",
    "df_processed_X.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "f0b1101f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>num__Age</th>\n",
       "      <th>num__Number of Dependents</th>\n",
       "      <th>num__Number of Referrals</th>\n",
       "      <th>num__Tenure in Months</th>\n",
       "      <th>num__Avg Monthly GB Download</th>\n",
       "      <th>num__Monthly Charge</th>\n",
       "      <th>num__Total Charges</th>\n",
       "      <th>num__Total Long Distance Charges</th>\n",
       "      <th>num__Total Revenue</th>\n",
       "      <th>cat__Married_No</th>\n",
       "      <th>...</th>\n",
       "      <th>cat__Unlimited Data_No</th>\n",
       "      <th>cat__Unlimited Data_Yes</th>\n",
       "      <th>cat__Contract_Month-to-Month</th>\n",
       "      <th>cat__Contract_One Year</th>\n",
       "      <th>cat__Contract_Two Year</th>\n",
       "      <th>cat__Paperless Billing_No</th>\n",
       "      <th>cat__Paperless Billing_Yes</th>\n",
       "      <th>cat__Payment Method_Bank Withdrawal</th>\n",
       "      <th>cat__Payment Method_Credit Card</th>\n",
       "      <th>cat__Payment Method_Mailed Check</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-0.579600</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.006926</td>\n",
       "      <td>-1.063957</td>\n",
       "      <td>-0.521001</td>\n",
       "      <td>0.018307</td>\n",
       "      <td>-0.811689</td>\n",
       "      <td>-0.487965</td>\n",
       "      <td>-0.791908</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>-0.045161</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.668349</td>\n",
       "      <td>-1.063957</td>\n",
       "      <td>-0.862269</td>\n",
       "      <td>-2.219753</td>\n",
       "      <td>-0.834158</td>\n",
       "      <td>-0.822156</td>\n",
       "      <td>-0.919617</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.192368</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.668349</td>\n",
       "      <td>-1.272578</td>\n",
       "      <td>0.275292</td>\n",
       "      <td>0.285202</td>\n",
       "      <td>-0.949616</td>\n",
       "      <td>-0.777187</td>\n",
       "      <td>-0.987873</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.855067</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.337638</td>\n",
       "      <td>-0.897060</td>\n",
       "      <td>-1.203538</td>\n",
       "      <td>1.060162</td>\n",
       "      <td>-0.527161</td>\n",
       "      <td>-0.511217</td>\n",
       "      <td>-0.573051</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.676921</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>0.323785</td>\n",
       "      <td>-1.314302</td>\n",
       "      <td>-0.805391</td>\n",
       "      <td>0.606762</td>\n",
       "      <td>-0.955553</td>\n",
       "      <td>-0.908919</td>\n",
       "      <td>-1.031984</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 50 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   num__Age  num__Number of Dependents  num__Number of Referrals  \\\n",
       "0 -0.579600                  -0.491619                 -0.006926   \n",
       "1 -0.045161                  -0.491619                 -0.668349   \n",
       "2  0.192368                  -0.491619                 -0.668349   \n",
       "3  1.855067                  -0.491619                 -0.337638   \n",
       "4  1.676921                  -0.491619                  0.323785   \n",
       "\n",
       "   num__Tenure in Months  num__Avg Monthly GB Download  num__Monthly Charge  \\\n",
       "0              -1.063957                     -0.521001             0.018307   \n",
       "1              -1.063957                     -0.862269            -2.219753   \n",
       "2              -1.272578                      0.275292             0.285202   \n",
       "3              -0.897060                     -1.203538             1.060162   \n",
       "4              -1.314302                     -0.805391             0.606762   \n",
       "\n",
       "   num__Total Charges  num__Total Long Distance Charges  num__Total Revenue  \\\n",
       "0           -0.811689                         -0.487965           -0.791908   \n",
       "1           -0.834158                         -0.822156           -0.919617   \n",
       "2           -0.949616                         -0.777187           -0.987873   \n",
       "3           -0.527161                         -0.511217           -0.573051   \n",
       "4           -0.955553                         -0.908919           -1.031984   \n",
       "\n",
       "   cat__Married_No  ...  cat__Unlimited Data_No  cat__Unlimited Data_Yes  \\\n",
       "0              0.0  ...                     0.0                      1.0   \n",
       "1              1.0  ...                     1.0                      0.0   \n",
       "2              1.0  ...                     0.0                      1.0   \n",
       "3              0.0  ...                     0.0                      1.0   \n",
       "4              0.0  ...                     0.0                      1.0   \n",
       "\n",
       "   cat__Contract_Month-to-Month  cat__Contract_One Year  \\\n",
       "0                           0.0                     1.0   \n",
       "1                           1.0                     0.0   \n",
       "2                           1.0                     0.0   \n",
       "3                           1.0                     0.0   \n",
       "4                           1.0                     0.0   \n",
       "\n",
       "   cat__Contract_Two Year  cat__Paperless Billing_No  \\\n",
       "0                     0.0                        0.0   \n",
       "1                     0.0                        1.0   \n",
       "2                     0.0                        0.0   \n",
       "3                     0.0                        0.0   \n",
       "4                     0.0                        0.0   \n",
       "\n",
       "   cat__Paperless Billing_Yes  cat__Payment Method_Bank Withdrawal  \\\n",
       "0                         1.0                                  0.0   \n",
       "1                         0.0                                  0.0   \n",
       "2                         1.0                                  1.0   \n",
       "3                         1.0                                  1.0   \n",
       "4                         1.0                                  0.0   \n",
       "\n",
       "   cat__Payment Method_Credit Card  cat__Payment Method_Mailed Check  \n",
       "0                              1.0                               0.0  \n",
       "1                              1.0                               0.0  \n",
       "2                              0.0                               0.0  \n",
       "3                              0.0                               0.0  \n",
       "4                              1.0                               0.0  \n",
       "\n",
       "[5 rows x 50 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#selecting the best features from the preprocessing data\n",
    "from sklearn.feature_selection import SelectKBest\n",
    "from sklearn.feature_selection import chi2\n",
    "from sklearn.feature_selection import f_classif\n",
    "\n",
    "selector = SelectKBest(f_classif, k=50)\n",
    "selector.fit_transform(df_processed_X, df_y)\n",
    "\n",
    "cols = selector.get_support(indices=True)\n",
    "features_df_new = df_processed_X.iloc[:,cols]\n",
    "\n",
    "features_df_new.head() #printing the top values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "89112cf4",
   "metadata": {},
   "outputs": [],
   "source": [
    "r_f_c = RandomForestClassifier(n_estimators=20, random_state=42) #Using random forest classification\n",
    "s_f_s = SequentialFeatureSelector(r_f_c) # Using sequential feature selector\n",
    "s_f_s.fit(features_df_new, df_y)\n",
    "SequentialFeatureSelector(estimator=RandomForestClassifier(n_estimators=20, random_state=42))\n",
    "s_f_s.get_support()\n",
    "new_df = s_f_s.transform(features_df_new)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "4075f720",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['num__Age', 'num__Number of Dependents', 'num__Number of Referrals',\n",
       "       'num__Tenure in Months', 'num__Monthly Charge', 'cat__City_San Diego',\n",
       "       'cat__City_Temecula', 'cat__Zip Code_91773', 'cat__Zip Code_92028',\n",
       "       'cat__Zip Code_92122', 'cat__Zip Code_92126', 'cat__Zip Code_92129',\n",
       "       'cat__Zip Code_92592', 'cat__Internet Service_No',\n",
       "       'cat__Internet Service_Yes', 'cat__Internet Type_DSL',\n",
       "       'cat__Online Security_Yes', 'cat__Online Backup_Yes',\n",
       "       'cat__Device Protection Plan_No', 'cat__Premium Tech Support_No',\n",
       "       'cat__Unlimited Data_No', 'cat__Contract_Month-to-Month',\n",
       "       'cat__Contract_One Year', 'cat__Contract_Two Year',\n",
       "       'cat__Payment Method_Mailed Check'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cols1 = s_f_s.get_support(indices=True) #retrieving the indices of the selected features\n",
    "df_3 = features_df_new.iloc[:,cols1] #creating the dataframe for the selected features\n",
    "df_3.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "4078c41a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>num__Age</th>\n",
       "      <th>num__Number of Dependents</th>\n",
       "      <th>num__Number of Referrals</th>\n",
       "      <th>num__Tenure in Months</th>\n",
       "      <th>num__Monthly Charge</th>\n",
       "      <th>cat__City_San Diego</th>\n",
       "      <th>cat__City_Temecula</th>\n",
       "      <th>cat__Zip Code_91773</th>\n",
       "      <th>cat__Zip Code_92028</th>\n",
       "      <th>cat__Zip Code_92122</th>\n",
       "      <th>...</th>\n",
       "      <th>cat__Internet Type_DSL</th>\n",
       "      <th>cat__Online Security_Yes</th>\n",
       "      <th>cat__Online Backup_Yes</th>\n",
       "      <th>cat__Device Protection Plan_No</th>\n",
       "      <th>cat__Premium Tech Support_No</th>\n",
       "      <th>cat__Unlimited Data_No</th>\n",
       "      <th>cat__Contract_Month-to-Month</th>\n",
       "      <th>cat__Contract_One Year</th>\n",
       "      <th>cat__Contract_Two Year</th>\n",
       "      <th>cat__Payment Method_Mailed Check</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>-0.579600</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.006926</td>\n",
       "      <td>-1.063957</td>\n",
       "      <td>0.018307</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>-0.045161</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.668349</td>\n",
       "      <td>-1.063957</td>\n",
       "      <td>-2.219753</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.192368</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.668349</td>\n",
       "      <td>-1.272578</td>\n",
       "      <td>0.285202</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.855067</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>-0.337638</td>\n",
       "      <td>-0.897060</td>\n",
       "      <td>1.060162</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.676921</td>\n",
       "      <td>-0.491619</td>\n",
       "      <td>0.323785</td>\n",
       "      <td>-1.314302</td>\n",
       "      <td>0.606762</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   num__Age  num__Number of Dependents  num__Number of Referrals  \\\n",
       "0 -0.579600                  -0.491619                 -0.006926   \n",
       "1 -0.045161                  -0.491619                 -0.668349   \n",
       "2  0.192368                  -0.491619                 -0.668349   \n",
       "3  1.855067                  -0.491619                 -0.337638   \n",
       "4  1.676921                  -0.491619                  0.323785   \n",
       "\n",
       "   num__Tenure in Months  num__Monthly Charge  cat__City_San Diego  \\\n",
       "0              -1.063957             0.018307                  0.0   \n",
       "1              -1.063957            -2.219753                  0.0   \n",
       "2              -1.272578             0.285202                  0.0   \n",
       "3              -0.897060             1.060162                  0.0   \n",
       "4              -1.314302             0.606762                  0.0   \n",
       "\n",
       "   cat__City_Temecula  cat__Zip Code_91773  cat__Zip Code_92028  \\\n",
       "0                 0.0                  0.0                  0.0   \n",
       "1                 0.0                  0.0                  0.0   \n",
       "2                 0.0                  0.0                  0.0   \n",
       "3                 0.0                  0.0                  0.0   \n",
       "4                 0.0                  0.0                  0.0   \n",
       "\n",
       "   cat__Zip Code_92122  ...  cat__Internet Type_DSL  cat__Online Security_Yes  \\\n",
       "0                  0.0  ...                     0.0                       0.0   \n",
       "1                  0.0  ...                     0.0                       0.0   \n",
       "2                  0.0  ...                     0.0                       0.0   \n",
       "3                  0.0  ...                     0.0                       0.0   \n",
       "4                  0.0  ...                     0.0                       0.0   \n",
       "\n",
       "   cat__Online Backup_Yes  cat__Device Protection Plan_No  \\\n",
       "0                     1.0                             1.0   \n",
       "1                     0.0                             1.0   \n",
       "2                     0.0                             0.0   \n",
       "3                     1.0                             0.0   \n",
       "4                     0.0                             1.0   \n",
       "\n",
       "   cat__Premium Tech Support_No  cat__Unlimited Data_No  \\\n",
       "0                           0.0                     0.0   \n",
       "1                           1.0                     1.0   \n",
       "2                           1.0                     0.0   \n",
       "3                           1.0                     0.0   \n",
       "4                           0.0                     0.0   \n",
       "\n",
       "   cat__Contract_Month-to-Month  cat__Contract_One Year  \\\n",
       "0                           0.0                     1.0   \n",
       "1                           1.0                     0.0   \n",
       "2                           1.0                     0.0   \n",
       "3                           1.0                     0.0   \n",
       "4                           1.0                     0.0   \n",
       "\n",
       "   cat__Contract_Two Year  cat__Payment Method_Mailed Check  \n",
       "0                     0.0                               0.0  \n",
       "1                     0.0                               0.0  \n",
       "2                     0.0                               0.0  \n",
       "3                     0.0                               0.0  \n",
       "4                     0.0                               0.0  \n",
       "\n",
       "[5 rows x 25 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "telecom_data = df_3\n",
    "telecom_data.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "11d837a3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "((5271, 25), (1318, 25), (5271,), (1318,))"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn.model_selection import train_test_split   #importing the modules\n",
    "from sklearn.preprocessing import LabelEncoder \n",
    "\n",
    "train_X, test_X, train_y, test_y = train_test_split(telecom_data, df_y, test_size = .2, random_state=0)\n",
    "#splitting the data into test and train sets\n",
    "le = LabelEncoder()  #encoding the categorial labels into the numerical values\n",
    "train_y = le.fit_transform(train_y)\n",
    "test_y = le.fit_transform(test_y)\n",
    "\n",
    "train_X.shape, test_X.shape, train_y.shape, test_y.shape #printing the shapes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "722ca47c",
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier #importing the necessary modules\n",
    "from sklearn.model_selection import cross_val_score\n",
    "\n",
    "random_forest_clf = RandomForestClassifier(n_estimators=100, random_state=0) #random forest classifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "341ebf4d",
   "metadata": {},
   "outputs": [],
   "source": [
    "random_forest_clf_scores_a = cross_val_score(random_forest_clf, train_X, train_y, cv=10, scoring='accuracy')\n",
    "random_forest_clf_scores_ba = cross_val_score(random_forest_clf, train_X, train_y, cv=10, scoring='balanced_accuracy')\n",
    "random_forest_clf_scores_p = cross_val_score(random_forest_clf, train_X, train_y, cv=10, scoring='precision')\n",
    "random_forest_clf_scores_r = cross_val_score(random_forest_clf, train_X, train_y, cv=10, scoring='recall')\n",
    "random_forest_clf_scores_f1 = cross_val_score(random_forest_clf, train_X, train_y, cv=10, scoring='f1')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "2c5a691c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy: 0.8676\n",
      "Balanced Accuracy: 0.8176\n",
      "Precision: 0.8868\n",
      "Recall: 0.9341\n",
      "F1-score: 0.9098\n"
     ]
    }
   ],
   "source": [
    "print('Accuracy:',random_forest_clf_scores_a.mean().round(4))  #printing the values\n",
    "print('Balanced Accuracy:', random_forest_clf_scores_ba.mean().round(4))\n",
    "print('Precision:', random_forest_clf_scores_p.mean().round(4))\n",
    "print('Recall:', random_forest_clf_scores_r.mean().round(4))\n",
    "print('F1-score:', random_forest_clf_scores_f1.mean().round(4))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "3417cdc0",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
